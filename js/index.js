!function(e){var t={};function i(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(r,o,function(t){return e[t]}.bind(null,o));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var r=function(){this.name="",this.level="",this.activeSkillLevel="",this.passiveSkillLevel="",this.supportSkillLevel="",this.isPossession=!1},o=function(){this.name="",this.favorability=""},n=function(){function e(){this.bromideList=[],this.favorabilityList=[];var t=localStorage.getItem(e.LOCAL_STORAGE_KEY);if(t){var i=JSON.parse(t);this.bromideList=i.bromideList,this.favorabilityList=i.favorabilityList}}return e.prototype.save=function(){localStorage.setItem(e.LOCAL_STORAGE_KEY,JSON.stringify(this))},e.prototype.getBromide=function(e,t){for(var i=0,o=this.bromideList;i<o.length;i++){var n=o[i];if(n.name===e)return n}var l=new r;return l.name=e,l.level=""+t,l.activeSkillLevel="10",l.passiveSkillLevel="10",l.supportSkillLevel="10",l.isPossession=!1,this.bromideList.push(l),l},e.prototype.getFavorability=function(e){for(var t=0,i=this.favorabilityList;t<i.length;t++){var r=i[t];if(r.name===e)return r}var n=new o;return n.name=e,n.favorability="3",this.favorabilityList.push(n),n},e.LOCAL_STORAGE_KEY="SB69FES",e}(),l=function(){function e(){}return e.load=function(e){var t=e.split(/\r\n|\r|\n/g),i=[],r=t[0].split(/\t/g);t.shift();for(var o=function(e){var t=e.split(/\t/g),o={};r.forEach((function(e,i){o[e]=t[i]})),i.push(o)},n=0,l=t;n<l.length;n++){o(l[n])}return i},e}(),a=function(){function e(){}return e.getParam=function(){for(var e={},t=0,i=location.search.substring(1).split("&");t<i.length;t++){var r=i[t],o=r.search(/=/);if(-1!==o){var n=decodeURI(r.slice(0,o)),l=decodeURI(r.slice(o+1));if(-1!==n.search(/\[\]$/)){var a=n.substring(0,n.length-2),s=e[a];s instanceof Array?s.push(l):e[a]=[l]}else e[n]=l}}return e},e.get=function(e,t,i,r){var o=new XMLHttpRequest;o.open("get",e,!0),i&&o.addEventListener("load",(function(e){o.status>=200&&o.status<300?i(o.responseText):r&&r()})),r&&o.addEventListener("error",(function(e){r()})),o.send(t)},e}(),s=function(){function e(){}return e.getMaxLevel=function(e){switch(e){case"UR":return 60;case"SSR":return 55;case"SR":return 50;case"RR":return 40;case"R":return 30;default:return 0}},e.getFavorabilityCorrection=function(e){switch(e){case"親友":case"3":return 1.049999;case"友達":case"2":return 1.03;default:return 1}},e}(),u=function(){function e(e,t,i,r,o){void 0===o&&(o=1),this.life=0,this.rhythm=0,this.melody=0,this.harmony=0,this.sum=0,this.supportLife=0,this.supportRhythm=0,this.supportMelody=0,this.supportHarmony=0,this.supportSum=0,this.memberStatusEvaluation=0,this.supportStatusEvaluation=0,this.life=parseInt(e.life)+parseInt(t.life);var n=(parseInt(e.rhythm)+parseInt(t.rhythm))*o,l=(parseInt(e.melody)+parseInt(t.melody))*o,a=(parseInt(e.harmony)+parseInt(t.harmony))*o;this.rhythm=Math.floor(n*(r?1.2:1)),this.melody=Math.floor(l*(r?1.2:1)),this.harmony=Math.floor(a*(r?1.2:1)),this.sum=this.rhythm+this.melody+this.harmony,this.supportLife=Math.floor(this.life*parseFloat(i.supportLife)/100),this.supportRhythm=Math.floor(Math.floor(n)*parseFloat(i.supportRhythm)/100),this.supportMelody=Math.floor(Math.floor(l)*parseFloat(i.supportMelody)/100),this.supportHarmony=Math.floor(Math.floor(a)*parseFloat(i.supportHarmony)/100),this.supportSum=this.supportRhythm+this.supportMelody+this.supportHarmony}return e.prototype.calcEvaluation=function(e,t,i){var r=e+t+i,o=r?e/r:.333,n=r?t/r:.333,l=r?i/r:.333;this.memberStatusEvaluation=Math.floor(this.rhythm*o+this.melody*n+this.harmony*l),this.supportStatusEvaluation=Math.floor(this.supportRhythm*o+this.supportMelody*n+this.supportHarmony*l)},e}(),d=function(){function e(t,i,r,o,n){this.bromide=t,this.storageBromide=i,this.storageFavorability=r,e.growMaster=o,e.skillMaster=n,this.bromideName=t.name,this.level=parseInt(i.level),this.maxLevel=s.getMaxLevel(t.rarity);var l=e.growMaster[this.bromide.growType+"|"+this.level],a=e.skillMaster[this.bromide.supportSkill+"|"+this.storageBromide.supportSkillLevel];this.favorabilityCorrection=this.storageFavorability?s.getFavorabilityCorrection(this.storageFavorability.favorability):1,this.withFavorability=new u(this.bromide,l,a,!1,this.favorabilityCorrection),this.origin=new u(this.bromide,l,a,!1),this.withOption=this.origin,this.withTypeOption=this.origin}return e.prototype.update=function(t){t&&(this.level=parseInt(t));var i=e.growMaster[this.bromide.growType+"|"+this.level],r=e.skillMaster[this.bromide.supportSkill+"|"+this.storageBromide.supportSkillLevel];this.favorabilityCorrection=this.storageFavorability?s.getFavorabilityCorrection(this.storageFavorability.favorability):1,this.withFavorability=new u(this.bromide,i,r,!1,this.favorabilityCorrection),this.origin=new u(this.bromide,i,r,!1),this.withOption=this.origin,this.withTypeOption=this.origin},e.prototype.calcWithOptionStatus=function(t,i,r,o,n,l,a){var d=i?this.maxLevel:this.level,c=r?"10":this.storageBromide.supportSkillLevel,m=this.bromide.type===t,v=o?s.getFavorabilityCorrection("親友"):this.favorabilityCorrection,p=e.growMaster[this.bromide.growType+"|"+d],y=e.skillMaster[this.bromide.supportSkill+"|"+c];this.withTypeOption=new u(this.bromide,p,y,m,v),this.withTypeOption.calcEvaluation(n,l,a),this.withOption=new u(this.bromide,p,y,!1,v),this.withOption.calcEvaluation(n,l,a)},e}();(function(){function e(){}return e.init=function(){var e=this;window.addEventListener("DOMContentLoaded",(function(){a.get("./data/bandlist.tsv",null,(function(t){e.bandList=l.load(t),e.draw()})),a.get("./data/myumonlist.tsv",null,(function(t){e.myumonList=l.load(t),e.draw()})),a.get("./data/bromidelist.tsv",null,(function(t){e.bromideList=l.load(t),e.draw()})),a.get("./data/growmaster.tsv",null,(function(t){for(var i=l.load(t),r=0,o=i;r<o.length;r++){var n=o[r];e.growMaster[n.type+"|"+n.level]=n}e.growMasterList=i,e.draw()})),a.get("./data/skillmaster.tsv",null,(function(t){for(var i=l.load(t),r=0,o=i;r<o.length;r++){var n=o[r];e.skillMaster[n.name+"|"+n.level]=n}e.skillMasterList=i,e.draw()})),Array.prototype.forEach.call(document.querySelectorAll("nav li"),(function(e){e.addEventListener("click",(function(t){var i=t.target.dataset.relationarea;Array.prototype.forEach.call(document.querySelectorAll(".main-area"),(function(e){e.id===i?e.style.display="block":e.style.display="none"})),Array.prototype.forEach.call(document.querySelectorAll("nav li"),(function(t){t.className=e===t?"select":""}))}))}))}))},e.createLevelSelect=function(e){if(this.levelSelectEle[e])return this.levelSelectEle[e].cloneNode(!0);for(var t=document.createElement("select"),i=60===e?35:1,r=e;r>=i;r--){var o=document.createElement("option");o.value=""+r,o.innerHTML=""+r,t.appendChild(o)}return this.levelSelectEle[e]=t,t},e.drawSettingFavorability=function(){var e,t,i=this,r=null===(e=document.querySelector("#setting-favorability .myumon"))||void 0===e?void 0:e.cloneNode(!0),o=document.querySelector("#setting-favorability .myumon-list");o.innerHTML="";for(var n=0,l=0,a=this.myumonList;l<a.length;l++){var s=a[l],u=r.cloneNode(!0),d=this.storage.getFavorability(s.name);u.querySelector(".band").innerHTML=s.band,u.querySelector(".name").innerHTML=s.name,u.querySelector(".acquaintance").name="nyumon"+n,u.querySelector(".acquaintance").id="nyumon-acquaintance-"+n,u.querySelector(".acquaintance + label").htmlFor="nyumon-acquaintance-"+n,u.querySelector(".friend").name="nyumon"+n,u.querySelector(".friend").id="nyumon-friend-"+n,u.querySelector(".friend + label").htmlFor="nyumon-friend-"+n,u.querySelector(".best-friend").name="nyumon"+n,u.querySelector(".best-friend").id="nyumon-best-friend-"+n,u.querySelector(".best-friend + label").htmlFor="nyumon-best-friend-"+n,u.querySelector('input[value="'+d.favorability+'"]').checked=!0,null===(t=o)||void 0===t||t.appendChild(u),Array.prototype.forEach.call(u.querySelectorAll("input"),(function(e){e.addEventListener("change",(function(e){var t,r,o,n=e.target,l=n.value,a=(null===(o=null===(r=null===(t=n.parentElement)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.querySelector(".name")).innerHTML;i.storage.getFavorability(a).favorability=l,i.storage.save(),i.updateBromideStatusWithMyumonName(a)}))})),n++}},e.updateBromideStatusWithMyumonName=function(e){var t=this;Array.prototype.forEach.call(document.querySelectorAll('#setting-bromide .bromide input.myumon-name[value="'+e+'"]'),(function(e){var i=e.parentElement.querySelector(".name").innerHTML;t.updateBromideStatusWithBromideName(i)}))},e.updateBromideStatusWithBromideName=function(e,t){var i,r=null===(i=document.querySelector('#setting-bromide .bromide input.bromide-name[value="'+e+'"]'))||void 0===i?void 0:i.parentElement,o=this.bromideStatusList.filter((function(t){return t.bromideName===e}))[0];o&&(o.update(t),r.querySelector(".life").innerHTML=""+o.withFavorability.life,r.querySelector(".rhythm").innerHTML=o.withFavorability.rhythm+" ("+o.origin.rhythm+")",r.querySelector(".melody").innerHTML=o.withFavorability.melody+" ("+o.origin.melody+")",r.querySelector(".harmony").innerHTML=o.withFavorability.harmony+" ("+o.origin.harmony+")")},e.drawSettingBromide=function(){var e,t,i=this,r=null===(e=document.querySelector("#setting-bromide .bromide"))||void 0===e?void 0:e.cloneNode(!0),o=document.querySelector("#setting-bromide .bromide-list");o.innerHTML="";for(var n=0,l={"ドキドキ":"dokidoki","キラキラ":"kirakira","ピカピカ":"pikapika"},a=function(e){var a=r.cloneNode(!0),c=u.storage.getBromide(e.name,s.getMaxLevel(e.rarity)),m=u.storage.favorabilityList.filter((function(t){return t.name===e.myumon}))[0],v=new d(e,c,m,u.growMaster,u.skillMaster);u.bromideStatusList.push(v),a.id="bromide"+n,a.querySelector(".myumon-name").value=e.myumon,a.querySelector(".bromide-name").value=e.name,a.querySelector(".type .icon-"+l[e.type]).style.display="inline",a.querySelector(".band").innerHTML=e.band,a.querySelector(".rarity").innerHTML=e.rarity,a.querySelector(".name").innerHTML=e.name,a.querySelector("input.possession").id="possession"+n,a.querySelector("input.possession").checked=c.isPossession,a.querySelector("label.possession").htmlFor="possession"+n,a.querySelector(".life").innerHTML=""+v.origin.life,a.querySelector(".rhythm").innerHTML=v.withFavorability.rhythm+" ("+v.origin.rhythm+")",a.querySelector(".melody").innerHTML=v.withFavorability.melody+" ("+v.origin.melody+")",a.querySelector(".harmony").innerHTML=v.withFavorability.harmony+" ("+v.origin.harmony+")",a.querySelector(".select-level").appendChild(u.createLevelSelect(s.getMaxLevel(e.rarity))),a.querySelector(".select-level select").value=c.level,a.querySelector(".active-skill").innerHTML=e.activeSkill,a.querySelector(".passive-skill").innerHTML=e.passiveSkill||"-",a.querySelector(".support-skill").innerHTML=e.supportSkill,a.querySelector(".active-skill-level").style.visibility=e.activeSkill?"visible":"hidden",a.querySelector(".active-skill-level select").value=c.activeSkillLevel,a.querySelector(".passive-skill-level").style.visibility=e.passiveSkill?"visible":"hidden",a.querySelector(".passive-skill-level select").value=c.passiveSkillLevel,a.querySelector(".support-skill-level").style.visibility=e.supportSkill?"visible":"hidden",a.querySelector(".support-skill-level select").value=c.supportSkillLevel,null===(t=o)||void 0===t||t.appendChild(a),a.querySelector(".select-level select").addEventListener("change",(function(e){var t,r,o,n=e.target,l=n.value,a=null===(o=null===(r=null===(t=n.parentElement)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.parentElement,u=a.querySelector(".name").innerHTML,d=a.querySelector(".rarity").innerHTML;i.storage.getBromide(u,s.getMaxLevel(d)).level=l,i.storage.save(),i.updateBromideStatusWithBromideName(u,l)})),a.querySelector("input.possession").addEventListener("change",(function(e){var t,r,o,n,l,a,u=e.target,d=u.checked,c=(null===(o=null===(r=null===(t=u.parentElement)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.querySelector(".name")).innerHTML,m=(null===(a=null===(l=null===(n=u.parentElement)||void 0===n?void 0:n.parentElement)||void 0===l?void 0:l.parentElement)||void 0===a?void 0:a.querySelector(".rarity")).innerHTML;i.storage.getBromide(c,s.getMaxLevel(m)).isPossession=d,i.storage.save()})),a.querySelector(".active-skill-level select").addEventListener("change",(function(e){var t,r,o,n,l,a,u,d,c=e.target,m=c.value,v=(null===(n=null===(o=null===(r=null===(t=c.parentElement)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.parentElement)||void 0===n?void 0:n.querySelector(".name")).innerHTML,p=(null===(d=null===(u=null===(a=null===(l=c.parentElement)||void 0===l?void 0:l.parentElement)||void 0===a?void 0:a.parentElement)||void 0===u?void 0:u.parentElement)||void 0===d?void 0:d.querySelector(".rarity")).innerHTML;i.storage.getBromide(v,s.getMaxLevel(p)).activeSkillLevel=m,i.storage.save()})),a.querySelector(".passive-skill-level select").addEventListener("change",(function(e){var t,r,o,n,l,a,u,d,c=e.target,m=c.value,v=(null===(n=null===(o=null===(r=null===(t=c.parentElement)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.parentElement)||void 0===n?void 0:n.querySelector(".name")).innerHTML,p=(null===(d=null===(u=null===(a=null===(l=c.parentElement)||void 0===l?void 0:l.parentElement)||void 0===a?void 0:a.parentElement)||void 0===u?void 0:u.parentElement)||void 0===d?void 0:d.querySelector(".rarity")).innerHTML;i.storage.getBromide(v,s.getMaxLevel(p)).passiveSkillLevel=m,i.storage.save()})),a.querySelector(".support-skill-level select").addEventListener("change",(function(e){var t,r,o,n,l,a,u,d,c=e.target,m=c.value,v=(null===(n=null===(o=null===(r=null===(t=c.parentElement)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.parentElement)||void 0===n?void 0:n.querySelector(".name")).innerHTML,p=(null===(d=null===(u=null===(a=null===(l=c.parentElement)||void 0===l?void 0:l.parentElement)||void 0===a?void 0:a.parentElement)||void 0===u?void 0:u.parentElement)||void 0===d?void 0:d.querySelector(".rarity")).innerHTML;i.storage.getBromide(v,s.getMaxLevel(p)).supportSkillLevel=m,i.storage.save()})),n++},u=this,c=0,m=this.bromideList;c<m.length;c++){a(m[c])}},e.drawAutoFormation=function(){},e.drawAutoFormationResult=function(){var e,t,i=null===(e=document.querySelector("#auto-formation .member"))||void 0===e?void 0:e.cloneNode(!0),r=null===(t=document.querySelector("#auto-formation .support"))||void 0===t?void 0:t.cloneNode(!0),o=document.querySelector("#auto-formation .member-list"),n=document.querySelector("#auto-formation .support-list"),l=document.querySelector("#song-type input:checked").value||"100",a=parseInt(document.getElementById("song-rhythm").value||"100"),s=parseInt(document.getElementById("song-melody").value||"100"),u=parseInt(document.getElementById("song-harmony").value||"100"),d=document.getElementById("option-level-max").checked,c=document.getElementById("option-skill-level-max").checked,m=document.getElementById("option-favor-max").checked,v=document.getElementById("option-possession-all").checked;this.bromideStatusList.forEach((function(e){e.calcWithOptionStatus(l,d,c,m,a,s,u)}));var p=this.bromideStatusList.filter((function(e){return v||e.storageBromide.isPossession}));p.sort((function(e,t){return t.withTypeOption.memberStatusEvaluation-e.withTypeOption.memberStatusEvaluation}));var y=this.bromideStatusList.filter((function(e){return v||e.storageBromide.isPossession}));if(y.sort((function(e,t){return t.withTypeOption.supportStatusEvaluation-e.withTypeOption.supportStatusEvaluation})),0!==p.length){o.innerHTML="<h3>メンバー候補一覧</h3>",n.innerHTML="<h3>サポート候補一覧</h3>",document.querySelector("#result-list .result").style.display="block";for(var h={"ドキドキ":"dokidoki","キラキラ":"kirakira","ピカピカ":"pikapika"},f=0;f<10;f++){var S=i.cloneNode(!0),g=p[f];if(!g)break;S.className="member "+h[g.bromide.type],S.querySelector(".bromide .name").innerHTML=g.bromideName,S.querySelector(".bromide .level").innerHTML="Lv."+(d?g.maxLevel:g.level),S.querySelector(".active-skill .name").innerHTML=g.bromide.activeSkill,S.querySelector(".active-skill .level").innerHTML="Lv."+(c?10:g.storageBromide.activeSkillLevel),S.querySelector(".status .life").innerHTML=""+g.withTypeOption.life,S.querySelector(".status .rhythm").innerHTML=g.withTypeOption.rhythm+"<br>("+g.withOption.rhythm+")",S.querySelector(".status .melody").innerHTML=g.withTypeOption.melody+"<br>("+g.withOption.melody+")",S.querySelector(".status .harmony").innerHTML=g.withTypeOption.harmony+"<br>("+g.withOption.harmony+")",S.querySelector(".status .sum").innerHTML=g.withTypeOption.sum+"<br>("+g.withOption.sum+")",S.querySelector(".status .evaluation").innerHTML=""+g.withTypeOption.memberStatusEvaluation,o.appendChild(S)}for(var b=0;b<10;b++){var L=r.cloneNode(!0),M=y[b];if(!M)break;L.className="member support "+h[M.bromide.type],L.querySelector(".bromide .name").innerHTML=M.bromideName,L.querySelector(".bromide .level").innerHTML="Lv."+(d?M.maxLevel:M.level),L.querySelector(".active-skill .name").innerHTML=M.bromide.supportSkill,L.querySelector(".active-skill .level").innerHTML="Lv."+(c?10:M.storageBromide.supportSkillLevel),L.querySelector(".status .life").innerHTML=""+M.withTypeOption.supportLife,L.querySelector(".status .rhythm").innerHTML=""+M.withTypeOption.supportRhythm,L.querySelector(".status .melody").innerHTML=""+M.withTypeOption.supportMelody,L.querySelector(".status .harmony").innerHTML=""+M.withTypeOption.supportHarmony,L.querySelector(".status .sum").innerHTML=""+M.withTypeOption.supportSum,L.querySelector(".status .evaluation").innerHTML=""+M.withTypeOption.supportStatusEvaluation,n.appendChild(L)}}else alert("所持ブロマイドが設定されていません")},e.draw=function(){var e,t=this;0!==this.bandList.length&&0!==this.myumonList.length&&0!==this.bromideList.length&&0!==this.growMasterList.length&&0!==this.skillMasterList.length&&(this.drawSettingFavorability(),this.drawSettingBromide(),this.drawAutoFormation(),null===(e=document.getElementById("auto-formation-calc"))||void 0===e||e.addEventListener("click",(function(){t.drawAutoFormationResult()})))},e.bandList=[],e.myumonList=[],e.bromideList=[],e.growMasterList=[],e.growMaster={},e.skillMasterList=[],e.skillMaster={},e.bromideStatusList=[],e.storage=new n,e.levelSelectEle={},e})().init()}]);